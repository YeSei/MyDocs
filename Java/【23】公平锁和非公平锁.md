# 【23】公平锁和非公平锁
## 定义
**公平锁**：进程在请求一个锁时，锁若锁正在使用，则将该进程挂起到该资源等待队列中。等该锁释放时依次从队列中取出进程使用该资源。
**非公平锁**：进程在请求一个锁时，若锁正在使用，则将该进程挂起到资源等待队列中。等待unlock时依次唤醒。但是若锁此时正好释放，则直接获取锁进行使用，即lock不用再从等待队列中获取进程。

## 两者区别
公平锁在获取锁之前会先判断等待队列是否为空或者自己是否位于队列头部，该条件通过才能继续获取锁。**非公平锁会先查询资源状态，若可进入则会越过等待队列直接获取锁。**

只要每次进程来时，锁都是不可获取状态，此时非公平锁跟公平锁没有区别，依次进入FIFO队列等待调用。

## 执行效率
**非公平锁执行效率一般比公平锁效率要高**：因为非公平锁降低了进程的挂起，cpu上下文切换的效率。

## 附：
除了公平锁/非公平锁，还有：
独占锁：只能有一个线程获取锁。
重入锁：一个线程可以多次lock()，但是lock多少次就要unlock多少次。